## phpexcel不能读取wps表格插入的图片的解决方法

### 原因
WPS表格里插入的嵌入式图片 是=DISPIMG格式，这个图片是wps特有的功能，它不是shape, 有shapes集合中找不到。只能用wps的et表格打开才能看到这个图片
![](https://imgkr.cn-bj.ufileos.com/bf9b75b0-f70d-42e4-a88c-85ee2aa31dce.png)

这样插入的图片在office的excel里面打开是无法看到图片的，只能看到一个*#NAME*错误，点击单元格会显示类似于公式的字符串。
![](https://imgkr.cn-bj.ufileos.com/f7787b93-9694-43fd-9a27-36d4610bf9ec.png)

这样的excel文件上传服务器后，phpexcel，读取这个单元格的数据时，读取到的是一个公式，不是图片数据，所以会造成读取失败。

只有安装wps才能复现这个问题。重新下载安装了官网的回wps之后，打开文档，图片都能正常显示了。
这是因为DISPIMG是wps私有函数，且涉及到图片相关等其他模块(比如双击图片显示wps的看图模块)
`=DISPIMG("姓名18",1)`
这是一个很不好的情况（这个单元格图片功能确实很方便），文档应该尽量保证通用兼容。金山利用这个功能将用户限制在自己wps里才能使用。

### 解决方法
1.插入图片是选择浮动图片
2.右键图片选择设置为浮动图片